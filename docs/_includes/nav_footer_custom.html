<button class="theme-toggle-btn">Light</button>
<script>
(function() {
  var STORAGE_KEY = 'jtd-theme';

  function getTheme() {
    return localStorage.getItem(STORAGE_KEY) || 'dark';
  }

  function setTheme(theme) {
    localStorage.setItem(STORAGE_KEY, theme);
    var links = document.getElementsByTagName('link');
    for (var i = 0; i < links.length; i++) {
      var href = links[i].href;
      if (href && href.indexOf('just-the-docs-') !== -1 && href.indexOf('.css') !== -1) {
        if (theme === 'dark') {
          links[i].href = href.replace('just-the-docs-default', 'just-the-docs-dark');
        } else {
          links[i].href = href.replace('just-the-docs-dark', 'just-the-docs-default');
        }
      }
    }
    updateAllButtons();
  }

  function updateAllButtons() {
    var buttons = document.querySelectorAll('.theme-toggle-btn');
    var label = getTheme() === 'dark' ? 'Light' : 'Dark';
    for (var i = 0; i < buttons.length; i++) {
      buttons[i].textContent = label;
    }
  }

  // Only run setup once (first script instance)
  if (!window._themeToggleInitialized) {
    window._themeToggleInitialized = true;

    // Initialize all buttons when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', function() {
        updateAllButtons();
        attachListeners();
      });
    } else {
      updateAllButtons();
      attachListeners();
    }
  }

  function attachListeners() {
    var buttons = document.querySelectorAll('.theme-toggle-btn');
    for (var i = 0; i < buttons.length; i++) {
      buttons[i].addEventListener('click', function() {
        var newTheme = getTheme() === 'dark' ? 'light' : 'dark';
        setTheme(newTheme);
      });
    }
  }
})();
</script>
