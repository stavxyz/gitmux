<script>
// Theme toggle
(function() {
  var STORAGE_KEY = 'jtd-theme';

  function getTheme() {
    return localStorage.getItem(STORAGE_KEY) || 'dark';
  }

  function setTheme(theme) {
    localStorage.setItem(STORAGE_KEY, theme);
    var links = document.getElementsByTagName('link');
    for (var i = 0; i < links.length; i++) {
      var href = links[i].href;
      if (href && href.indexOf('just-the-docs-') !== -1 && href.indexOf('.css') !== -1) {
        if (theme === 'dark') {
          links[i].href = href.replace('just-the-docs-default', 'just-the-docs-dark');
        } else {
          links[i].href = href.replace('just-the-docs-dark', 'just-the-docs-default');
        }
      }
    }
  }

  // Swap stylesheet immediately on page load
  var saved = getTheme();
  if (!localStorage.getItem(STORAGE_KEY)) {
    localStorage.setItem(STORAGE_KEY, 'dark');
    saved = 'dark';
  }
  var links = document.getElementsByTagName('link');
  for (var i = 0; i < links.length; i++) {
    var href = links[i].href;
    if (href && href.indexOf('just-the-docs-') !== -1 && href.indexOf('.css') !== -1) {
      if (saved === 'dark') {
        links[i].href = href.replace('just-the-docs-default', 'just-the-docs-dark');
      }
    }
  }

  // Convert "Theme" link to working toggle after DOM loads
  document.addEventListener('DOMContentLoaded', function() {
    var themeLink = document.querySelector('a[href="#theme-toggle"]');
    if (themeLink) {
      themeLink.textContent = getTheme() === 'dark' ? 'Light' : 'Dark';
      themeLink.href = '#';
      themeLink.addEventListener('click', function(e) {
        e.preventDefault();
        var newTheme = getTheme() === 'dark' ? 'light' : 'dark';
        setTheme(newTheme);
        themeLink.textContent = newTheme === 'dark' ? 'Light' : 'Dark';
      });
    }
  });
})();
</script>
